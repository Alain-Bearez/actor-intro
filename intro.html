<html lang='en'>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=1024" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="author" content="Alain Fagot Béarez" />
<title>the greatest actors&#8217; distribution ever | Alain Fagot Béarez @AlainBearez</title>
<meta name="description" content="my first talk about actors powered by impress.js" />
<link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.css" />
<link rel="stylesheet" type="text/css" href="webfont-EnvyR/stylesheet.css" />
<link rel='stylesheet' type='text/css' href='http://fonts.googleapis.com/css?family=Archivo+Black|Archivo+Narrow:700&subset=latin,latin-ext'>
<link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shCoreEclipse.min.css" />
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shCore.js"></script>
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushScala.min.js"></script>
<style>
#impress{width:800;height:600}
/* 600: 24, 720: 28, 768: 30, 1024: 40 */
body{font-size:24px;font-family:'Archivo Narrow','Arial Narrow',sans-serif;text-align:center}
.syntaxhighlighter{font-size:19px !important}
.syntaxhighlighter div code .keyword,.syntaxhighlighter div code .value{font-family: 'envy_code_rbold',Monaco,Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace !important;font-weight:700}
.syntaxhighlighter div code .comments{font-family: 'envy_code_ritalic',Monaco,Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace !important;font-style:italic;color:rgb(63,127,95) !important}
.syntaxhighlighter code,.syntaxhighlighter div{font-family: 'envy_code_rregular',Monaco,Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace !important}
#impress>div{height:100%;width:100%}
section.step{display:block;height:100%;width:100%}/*;border:2px red solid}*/
.step.past{opacity:0.1;background-color:rgba(255,255,255,0.9)}
.step.present~.step.past,.step.future{display:none}
h1{font-family:'Archivo Black','Arial Black',sans-serif;font-size:200%;position:absolute;top:45%;right:5%;bottom:45%;left:5%}
h2{font-family:'Archivo Black','Arial Black',sans-serif;font-size:144%;margin:1.4em 0px 0px}
dl{text-align:left}
dt{margin:0.2em 10%;font-size:144%}
p{margin:0.7em 0px}
section>h2:nth-of-type(2),
section>div:nth-of-type(2),
section>p:nth-of-type(2)
{position:absolute;bottom:0.2em;left:0.2em}
section>h2:nth-of-type(3),
section>div:nth-of-type(3),
section>p:nth-of-type(3)
{position:absolute;bottom:0.2em;right:0.2em}
em{font-style:italic}
strong{font-weight:700}
pre,code{font-family:'envy_code_rregular',Monaco,"Bitstream Vera Sans Mono",Consolas,"Courier New",Courier,monospace !important}
blockquote{position:absolute;bottom:0.2em;left:0.2em;text-align:left;opacity:0.8}
.step.past blockquote{display:none}
ol.arabic{position:absolute;bottom:0.2em;left:0.2em;text-align:left;list-style-position:inside;list-style-type:decimal}
ol.arabic li{margin:0.6em 0px}
</style>
</head>
<body class="impress-not-supported">
<article id="impress" data-transition-duration='600'>
<section class='step' data-scale='1'>
<h1>the greatest actors&#8217; distribution ever</h1>
<p>&nbsp;</p>
<p>Alain Fagot Béarez</p>
<p><code>@AlainBearez</code></p>
</section>
<section class='step' data-z='10' data-scale='1.4142'>
<h1>three cities<br />with wonderful beaches</h1>
<h2>Barcelona</h2>
<h2>Montpellier</h2>
<h2>Fortaleza</h2>
<!--div>
<h2>Barcelona</h2>
<h3><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/f/ff/Espa%C3%B1aLoc.svg/290px-Espa%C3%B1aLoc.svg.png" alt="mapa Barcelona"></h3>
</div><div>
<h2>Montpellier</h2>
<h3><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/3/3b/France_location_map-Regions_and_departements.svg/275px-France_location_map-Regions_and_departements.svg.png" alt="mapa Montpellier"></h3>
</div><div>
<h2>Fortaleza</h2>
<h3><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/6/61/Ceara_Municip_Fortaleza.svg/280px-Ceara_Municip_Fortaleza.svg.png" alt="mapa Fortaleza"></h3>
</div-->
</section>
<section class='step' data-z='20' data-scale='2'>
<div>
<h2>abertis</h2>
<h3><img src="http://m.c.akam.licdn.com/media/p/2/000/023/19d/3310448.png" alt="logo abertis"></h3>
<p>telecommunication tower<br>
(radio+TV+GSM)</p>
</div>
<div>
<h2>Teads.tv</h2>
<h3><img src="http://m.c.akam.licdn.com/media/p/1/000/18f/214/020c38f.png" alt="logo Teads.tv"></h3>
<p>real-time ads auctions</p>
</div>
<div>
<h2>M2M solutions</h2>
<h3><img src="http://m.c.akam.licdn.com/media/p/3/000/0b9/1f6/19b1b18.png" alt="logo M2M solutions"></h3>
<p>bus monitoring</p>
</div>
</section>
<section class='step' data-z='30' data-scale='2.8284'>
<p>20,000 devices<br />
monitoring 10 to 20 parameters each</p>
<p>300ms to decide<br />
100,000 auctions per second</p>
<p>10,000 buses<br />
monitoring 20 indicators<br />
every 30s</p>
</section>
<section class='step' data-z='40' data-scale='4'>
<p>upon failure, activate redundant system<br />
and book the maintenance of fainted system</p>
<p>on page request,<br />&nbsp;start a new auction with deadline<br />
upon timeout,<br />&nbsp;discard late responses of bidders</p>
<p>real-time animated positions on the map<br />
estimated time to next stops</p>
</section>
<section class='step' data-z='50' data-scale='5.6569'>
<p>gigantic input data volume<br />
many volatile data<br />
constant flow of &quot;<em>observations</em>&quot;</p>
<p>short time for every operation<br />
&quot;<strong>now or never again</strong>&quot;</p>
<p>many quick and independent operations<br />
no time to read from disc<br />
each operation can throw new<br />&quot;<em>observations</em>&quot; to be handled</p>
</section>
<section class='step' data-z='60' data-scale='8'>
<h1 style='top:40%;bottom:40%'>necessity to handle<br />greater volume<br />every month</h1>
<p>avoid bottlenecks with databases<br />
through event logging</p>
<p>write highly cohesive code units<br />
dedicated to solve only one issue</p>
<p>distribute processing<br />
across several processors</p>
</section>
<section class='step' data-z='70' data-scale='11.3137'>
<h1>ACTOR</h1>
<div>
<h2>state</h2>
<p>result from handling the successive messages<br />through the successive behaviors<br />
local (and potentially erroneous) view of the universe</p>
</div><div>
<h2>mailbox</h2>
<p>local order of received messages<br />without any guarantee<br />
but preserving send order<br />for messages from same sender</p>
</div><div>
<h2>behavior</h2>
<p>can switch behavior<br />
when receiving some special message<br />
when NOT receiving before timeout</p>
</div>
</section>
<section class='step' data-z='80' data-x='-8000' data-scale='16'>
<h2>time travel</h2>
<dl>
<dt>2013</dt><dd>you are listening to a talk about actors</dd>
</dl>
</section>
<section class='step' data-z='80' data-x='-8000' data-scale='16'>
<h2>time travel</h2>
<dl>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>2003</dt><dd>first public release of Scala (without actors)</dd>
</dl>
</section>
<section class='step' data-z='80' data-x='-8000' data-scale='16'>
<h2>time travel</h2>
<dl>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>1993</dt><dd>start of my PhD in the field of distributed computing</dd>
</dl>
</section>
<section class='step' data-z='80' data-x='-8000' data-scale='16'>
<h2>time travel</h2>
<dl>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>1983</dt><dd>Symposium on Principles of Distributed Computing</dd>
</dl>
</section>
<section class='step' data-z='80' data-x='-8000' data-scale='16'>
<h2>time travel</h2>
<dl>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>1973</dt><dd>Carl Hewitt</dd>
</dl>
</section>
<section class='step'data-z='80'  data-x='-8000' data-scale='16'>
<h2>time travel</h2>
<dl>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>1963</dt><dd>Carl Adam Petri</dd>
</dl>
</section>
<section class='step' data-z='80' data-x='-8000' data-scale='16'>
<h2>time travel</h2>
<dl>
<dt>2013</dt><dd>you are listening to a talk about actors</dd>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>&nbsp;</dt><dd>&nbsp;</dd>
<dt>1973</dt><dd>Carl Hewitt</dd>
<dt>1963</dt><dd>Carl Adam Petri</dd>
</dl>
</section>
<section class='step' id='example' data-z='90' data-x='18000' data-y='-10000' data-scale='22.6274'>
<h1>Simple Actors Example</h1>
<ol class="arabic">
  <li>A few enterprises are created.</li>
  <li>Each enterprise buys some new vehicles and sets them to operate.</li>
  <li>Once operating, the satellite sends the vehicle&#8217;s position every 10s (±1s).</li>
  <li>Each vehicle logs its position for further use.</li>
</ol>
</section>
<section class='step' data-z='100' data-x='18000' data-y='3500' data-scale='22.6274'>
<blockquote cite="#example">A few enterprises are created.</blockquote>
<pre class="brush:scala;toolbar:false;highlight:[13,18]">
package cua.li.ti.vehicles
import akka.actor.{Actor,ActorLogging,ActorRef,ActorSystem,Props}
import scala.collection._
import scala.concurrent.Future
import scala.util.Random
object VehiclesSystem {
  def main(args :Array[String]) :Unit = {
    val system = ActorSystem(&quot;vehicles&quot;)
    system.actorOf(Props[Satellite], &quot;gps&quot;)
    val enterprises = for (index &lt;- 1 to 42)
      yield system.actorOf(Props[Enterprise], &quot;enterprise&quot;+index)
    for (enterprise &lt;- enterprises) {
      enterprise ! Protocol.Buy
    }
  }
}
object Protocol {
  case object Buy
  case class Operate(enterprise :String, plate :String)
  case class Heartbeat(vehicle :ActorRef)
  case class Position(lat :Double, lng :Double)
}
</pre>
</section>
<section class='step' data-z='110' data-x='18000' data-y='14000' data-scale='22.6274'>
<blockquote cite="#example">Each enterprise buys some new vehicles and sets them to operate.</blockquote>
<pre class="brush:scala;toolbar:false;first-line:23;highlight:29">
class Enterprise extends Actor {
  import Protocol._
  override def receive = {
    case Buy =&gt; {
      if (Random.nextBoolean) self ! Buy
      val vehicle = context.actorOf(Props[Vehicle])
      vehicle ! Operate(self.path.name, plate)
    }
  }
  private def plate = {
    val sb = StringBuilder.newBuilder
    for (letters &lt;- 0 until 3)
      sb += (&#39;A&#39;.toInt + Random.nextInt(26)).toChar
    sb += &#39;-&#39;
    for (numbers &lt;- 0 until 4)
      sb += (&#39;0&#39;.toInt + Random.nextInt(10)).toChar
    sb.toString
  }
}
</pre>
</section>
<section class='step' data-z='120' data-x='18000' data-y='23000' data-scale='22.6274'>
<blockquote cite="#example">Once operating, the satellite sends the vehicle&#8217;s position every 10s (±1s).</blockquote>
<pre class="brush:scala;toolbar:false;first-line:42;highlight:[47,48,49,50]">
class Satellite extends Actor {
  import context.dispatcher
  import Protocol._
  override def receive = {
    case Heartbeat(vehicle) =&gt; {
      val future = Future {
        Thread.sleep(9000+(Random.nextGaussian * 2000).toInt)
        self ! Heartbeat(vehicle)
      }
      vehicle ! Position(Random.nextDouble, Random.nextDouble)
    }
  }
}
</pre>
</section>
<section class='step' data-z='130' data-x='18000' data-y='29200' data-scale='22.6274'>
<blockquote cite="#example">Each vehicle logs its position for further use.</blockquote>
<pre class="brush:scala;toolbar:false;first-line:55;highlight:66">
class Vehicle extends Actor with ActorLogging {
  import Protocol._
  var plate = &quot;no plate&quot;
  var enterprise = &quot;no owner&quot;
  override def receive = {
    case Operate(owner, license) =&gt; {
      enterprise = owner
      plate = license
      context.actorSelection(&quot;/user/gps&quot;) ! Heartbeat(self)
    }
    case Position(lat, lng) =&gt;
      log.info(s&quot;in $enterprise, $plate at ($lat,$lng)&quot;)
  }
}
// That&#39;s all folks!
</pre>
</section>
<section class='step' data-z='140' data-x='18000' data-y='3700' data-scale='16'>
<h1>Patterns</h1>
</section>
<section class='step' data-z='150' data-x='18800' data-y='18500' data-scale='16'>
<h1><em>Corsican Worker</em></h1>
<p>&nbsp;</p>
<p>Don&#8217;t perform <em>right now</em><br />any <strong>hard</strong> work<br /> that can be done<br />in the <em>future</em>!</p>
<p>Let <em>somebody else</em><br />do the <strong>hard</strong> work for you.</p>
</section>
<section class='step' data-z='160' data-x='17700' data-y='20700' data-scale='16'>
<h1><em>Don&#8217;t Push!</em></h1>
<p>When dealing with <strong>hard</strong> work,<br />
let the workers ask for tasks<br />
when <em>they</em> are ready.</p>
<p>Spawn more workers <br />
when tasks are piling up.</p>
<p>Let the workers starve and die<br />
when only few tasks are remaining.</p>
</section>
<section class='step' data-z='170' data-x='21000' data-y='26300' data-scale='16'>
<h1><em>Now or Never Again</em></h1>
<p>&nbsp;</p>
<p>After some given delay,<br />
discard any late response.</p>
<p>Change behavior<br />
according to some<br />
Finite State Machine</p>
</section>
<section class='step' data-z='180' data-x='54000' data-y='-20000' data-scale='32'>
<h2>Futures and Promises</h2>
<blockquote>They are used to retrieve the result of some concurrent operation.</blockquote>
<pre class="brush:scala;toolbar:false">
val promise = Promise[String]()
val future = promise.future
future onSuccess {
  case &quot;bar&quot; =&gt; println(&quot;Got my bar alright!&quot;)
  case x: String =&gt; println(&quot;Got some random string: &quot; + x)
}
future onFailure {
  case ise: IllegalStateException =&gt;
    // We are in deep trouble, do something!
  case e: Exception =&gt;
    // Do something else
}
future onComplete {
  case Success(result) =&gt; doSomethingOnSuccess(result)
  case Failure(failure) =&gt; doSomethingOnFailure(failure)
}
// ...
promise.success(&quot;hello&quot;)
</pre>
</section>
<section class='step' data-z='190' data-x='54000' data-y='0' data-scale='32'>
<h1>Resilient Software</h1>
<p>Resilience is the capacity<br />to recover quickly from difficulties.</p>
<p>Asynchronous Message Passing</p>
<p>Loose Coupling and Supervision</p>
</section>
<section class='step' data-z='200' data-x='54000' data-y='30000' data-scale='45.2548'>
<h1>Command Query Responsibility Segregation</h1>
<p><a href="http://martinfowler.com/bliki/CQRS.html">http://martinfowler.com/bliki/CQRS.html</a></p>
<p><code style='font-size:111%'>CQRS</code> is <strong>not</strong> <code style='font-size:111%'>CRUD</code></p>
<p><em>Separate</em> object models,<br />
running in <em>different</em> processes,<br />
on <em>separate</em> hardware</p>
</section>
<section class='step' data-z='220' data-x='54000' data-y='60000'  data-scale='45.2548'>
<h1>Event Sourcing</h1>
<p><a href="http://martinfowler.com/eaaDev/EventSourcing.html">http://martinfowler.com/eaaDev/EventSourcing.html</a></p>
<p>ensure that all changes<br />
to application state<br />
are stored as a sequence of events</p>
<p>use the event log<br />
to reconstruct past states<br />
and to automatically adjust the state<br />
to cope with retroactive changes</p>
</section>
<section class='step' data-z='400' data-scale='1000'>
<h2>CodinGame</h2>
<blockquote cite="http://www.codingame.com/cg/#!challenge:17"><a href="http://www.codingame.com/cg/#!challenge:17">http://www.codingame.com/cg/#!challenge:17</a></blockquote>
<p><img src="http://www.invertexto.com/barcodes/1383314228.png" alt="CodinGame"></p>
</section>
</article>
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/impress.js/0.5.3/impress.min.js"></script>
<script>
impress().init()
SyntaxHighlighter.all()
</script>
</body>
</html>